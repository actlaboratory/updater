アップデータとサーバとの通信仕様 Version 1.0.0


1. 接続先

- https://actlab.org/api/checkUpdate
- リクエストにはHTTPSのGETメソッドを用います。

1. リクエストパラメータ

- リクエストには、以下の必須パラメータを含める必要があります。
	- name
		ソフトウェア毎に指定されたキーワード文字列で、大文字・小文字を区別します。
		(例：SOC)
	- updater_version
		実装している通信規格のバージョンを指定します。現在は「1.0.0」のみが有効です。
	- version
		実行中のソフトウェアのバージョンを指定します。(例：1.0.0)
- 将来利用する可能性があるため、以下のパラメータを付与しておくことを推奨します。
	- lang
		ユーザが利用中の言語を指定します。(例：ja-JP)
- パラメータは全てASCII文字の範囲で記述する必要があります。
- バージョンを表す文字列は0-9の数字と２つの.(ピリオド)で構成される必要があります。

1. レスポンスの検証

- サーバは、リクエストに対して必ずレスポンスコード200で応答します。それ以外のコードが返却された場合、サーバトラブルやメンテナンス、移転などが考えられます。
- 自動でのチェックの場合、レスポンスコードが200でない応答は無視することを推奨します。
- 手動でのチェックの場合、レスポンスコードが200でない応答の場合には通信に失敗したことを示すことを推奨します。
- これらの場合、返される本文の内容はこれ以降に記述する内容を満たすことを保証しません。

1. レスポンスの形式
- レスポンスは、json形式で返されjsonモジュールやrequestsなどで読み取れます。
- 応答には、必ず以下2つのプロパティーが存在します。
	- code
		次節で示す応答の種類を表します。
	- message
		人間のための簡単な解説です。原則英語で記載されます。
- その他、次節で示す各コード特有のプロパティーが追加される場合があります。
- ここで記載していないプロパティーが存在する可能性を排除しませんが、記載のないプロパティーの内容は無視しても構いません。
- 値には日本語等のASCII範囲外の文字が存在することがあり、その場合にはUTF-8でエンコードされます。
- messageに指定される文字列はあくまで参考としてのものであり、プログラムが内容を検証すること、ユーザに示されることを意図していません。メッセージは予告なく改変される可能性があります。

1. 応答コードの意味と追加パラメータおよび求められる行動

- 200 Please Update
	- リクエストで示されたバージョンよりも新しいバージョンが公開されており、自動でのアップデートが可能であることを示します。
	- このコードが示される場合、以下2つのプロパティーが追加で返されます。
		- updater_url
			- 示されたバージョンとの差分データを圧縮したファイルをダウンロード可能なURLです。
			- このURLからダウンロードできるファイルの形式および処理方法については、別に定められています。
		- update_description
			- アップデートの内容等を示す、原則として日本語の文字列です。将来的には、リクエストにlangパラメータがあれば多言語対応する可能性があります。
			- ここで示される内容は、ユーザに通知されても、されなくても構いません。
			- メッセージはプレーンテキストまたはHTMLで記述されている可能性があり、詳細な仕様は現在検討中です。
- 204 Your version is up to date
	- リクエストで示されたバージョンが最新であり、何もする必要がない事を示します。
- 205 Please visit website
	- ユーザはウェブサイトの内容を確認すべきであることを示します。
	- 自動でのアップデートが行えない場合や、緊急の連絡事項がある場合などに用いられます。
	- このコードが示される場合、以下のプロパティーが追加で返されます。
		- URL
			ユーザが閲覧すべきURLです。
		-info_description
			簡単な説明です。URLに誘導するためにユーザーに通知することを推奨します。
	- 自動での実行であっても、このコードを受け取った場合には速やかにユーザに通知することが求められます。
- 400 Required parameter not found
	- リクエストに必要なパラメータが不足しているか、形式が間違っていることを示します。
- 404 Requested name is not registed
	- リクエストのnameパラメータで示されたソフトウェアがデータベースに登録されていないことを示します。
	- 自動での実行の場合には、何もしないことを推奨します。
	- 手動での実行の場合には、ウェブサイトを確認し、原因がわからない場合には作者に問い合わせるように案内することを推奨します。
